# 📱 토스 앱에서 테스트하는 방법

이 문서는 로컬 개발 환경에서 토스 앱으로 테스트할 때 매번 따라야 하는 단계를 정리한 가이드입니다.

---

## ✅ 사전 체크리스트

- [ ] Mac과 iPhone이 **같은 WiFi**에 연결되어 있는가?
- [ ] 토스 앱이 설치되어 있는가?
- [ ] 토스 앱 개발자 모드 접근 권한이 있는가?

---

## 🚀 단계별 실행 방법

### 1단계: 터미널 열기
- VS Code 내장 터미널 또는 별도 터미널 앱 실행

### 2단계: 프로젝트 디렉토리로 이동
```bash
cd /Users/macintosh/Downloads/love-alarm
```

### 3단계: Granite 개발 서버 실행
```bash
npx granite dev
```

**예상 결과:**
```
 ██████╗ ██████╗  █████╗ ███╗   ██╗██╗████████╗███████╗
██╔════╝ ██╔══██╗██╔══██╗████╗  ██║██║╚══██╔══╝██╔════╝
...

Listening on http://0.0.0.0:8081
```

> ⚠️ **포트 번호 확인**: 화면에 표시된 포트 번호를 기억하세요 (보통 `8081`)

### 4단계: Mac의 IP 주소 확인
터미널에 다음 명령어를 입력:
```bash
ifconfig | grep "inet " | grep -v 127.0.0.1
```

**예상 결과:**
```
inet 192.168.45.237 netmask 0xffffff00 broadcast 192.168.45.255
```

> 📝 **IP 주소**: `192.168.45.237` 부분이 Mac의 현재 IP 주소입니다

**또는** Granite 실행 화면에서 Network 주소 확인:
```
➜  Local:   http://localhost:5173/
➜  Network: http://192.168.45.237:5173/  ← 이 IP 사용
```

### 5단계: 토스 앱에서 연결

#### 5-1. 토스 앱 실행
- iPhone에서 토스 앱 열기

#### 5-2. 개발자 모드 진입
- 토스 앱 내에서 개발자 모드로 진입
- (구체적인 진입 방법은 토스 내부 가이드 참고)

#### 5-3. Metro 서버 주소 입력
```
192.168.45.237:8081
```

형식: `[Mac IP 주소]:[Granite 포트]`

#### 5-4. 연결 버튼 클릭
- 앱이 로드되기 시작합니다

### 6단계: 테스트 시작! 🎉
- 이제 앱에서 모든 기능을 테스트할 수 있습니다
- 코드를 수정하면 자동으로 앱에 반영됩니다 (Hot Reload)

---

## 🛠️ 문제 해결

### 문제 1: "연결할 수 없습니다" 오류
**원인**: Mac과 iPhone이 다른 WiFi에 연결됨
**해결**: 둘 다 같은 WiFi에 연결

### 문제 2: IP 주소가 변경됨
**원인**: WiFi 재연결 시 IP가 변경될 수 있음
**해결**: 
1. 4단계에서 IP 주소 재확인
2. `granite.config.ts` 파일의 `host` 값 수정:
```typescript
web: {
  host: '새로운_IP_주소',  // 여기 수정
  port: 5173,
  ...
}
```
3. Granite 서버 재시작 (`Ctrl+C` 후 다시 `npx granite dev`)

### 문제 3: 권한 오류 (EPERM)
**원인**: npm 권한 문제
**해결**: 그냥 무시하고 진행 (Granite는 정상 실행됨)

### 문제 4: 포트가 이미 사용 중
**원인**: 이전 서버가 종료되지 않음
**해결**:
```bash
# 실행 중인 프로세스 확인
lsof -i :8081

# 프로세스 종료
kill -9 [PID]
```

---

## 🔄 테스트 종료하기

### 서버 종료
터미널에서 `Ctrl + C` 입력

### 완전 종료 확인
```bash
lsof -i :8081  # 아무것도 나오지 않아야 함
```

---

## 📋 요약 (빠른 참고용)

```bash
# 1. 프로젝트로 이동
cd /Users/macintosh/Downloads/love-alarm

# 2. Granite 실행
npx granite dev

# 3. IP 확인 (필요시)
ifconfig | grep "inet " | grep -v 127.0.0.1

# 4. 토스 앱에서 연결
# → 192.168.45.237:8081
```

---

## 💡 추가 정보

### 백엔드는?
- 백엔드는 Render 서버(`https://love-alarm-server.onrender.com`)를 자동으로 사용합니다
- 별도로 백엔드 서버를 실행할 필요 없습니다

### 브라우저에서도 테스트하려면?
- Granite 실행 후 브라우저에서 `http://localhost:5173` 접속
- 단, 토스 로그인은 앱에서만 작동합니다

### 코드 수정 후
- 파일 저장만 하면 자동으로 Hot Reload됩니다
- 서버 재시작 불필요

---

**마지막 업데이트**: 2024-12-30
**현재 IP**: 192.168.45.237
**현재 포트**: 8081


